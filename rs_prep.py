import numpy as np
import csv

posted_invoice_nos = ["PIV301313","PIV301313","PIV301313","PIV301313","PIV301313","PIV301313","PIV301313","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301337","PIV301340","PIV301340","PIV301340","PIV301340","PIV301340","PIV301340","PIV301340","PIV301340","PIV301340","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV302575","PIV303435","PIV303435","PIV303435","PIV303435","PIV303435","PIV303435","PIV303435","PIV303435","PIV303435","PIV303435","PIV303435","PIV304066","PIV304066","PIV304066","PIV304066","PIV304066","PIV304066","PIV304066","PIV304066","PIV304066","PIV304066","PIV304066","PIV304066","PIV304066","PIV304066","PIV304066","PIV304066","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304069","PIV304341","PIV304341","PIV304341","PIV304341","PIV304341","PIV304341","PIV304341","PIV304346","PIV304346","PIV304346","PIV304346","PIV304346","PIV304346","PIV304346","PIV304346","PIV304346","PIV304346","PIV304346","PIV304346","PIV304346","PIV304346","PIV304346","PIV304346","PIV304346","PIV304346","PIV304346","PIV304346","PIV304346","PIV304346","PIV304453","PIV304453","PIV304453","PIV304453","PIV304453","PIV304453","PIV304453","PIV304453","PIV304453","PIV304453","PIV304453","PIV304453","PIV304453","PIV304453","PIV304453","PIV304453","PIV304453","PIV304453","PIV304453","PIV304453","PIV304453","PIV304453","PIV304453","PIV304455","PIV304455","PIV304455","PIV304455","PIV304455","PIV304455","PIV304455","PIV304455","PIV304455","PIV304455","PIV304455","PIV304455","PIV304455","PIV304455","PIV304455","PIV304455","PIV304455","PIV304455","PIV304455","PIV304455","PIV304455","PIV304455","PIV304455","PIV304455","PIV304486","PIV304486","PIV304486","PIV304486","PIV304486","PIV304486","PIV304486","PIV304486","PIV304486","PIV304486","PIV304486","PIV304486","PIV304486","PIV304486","PIV304486","PIV304486","PIV304486","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304812","PIV304814","PIV304814","PIV304814","PIV304814","PIV304814","PIV304814","PIV304814","PIV304814","PIV304814","PIV304814","PIV304814","PIV304814","PIV304814","PIV304815","PIV304815","PIV304815","PIV304815","PIV304815","PIV304815","PIV304815","PIV304815","PIV304815","PIV304815","PIV304815","PIV304815","PIV304815","PIV304815"]


posted_invoice_line_nos_applied = [10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,20000,20000,30000,30000,30000,30000,30000,30000,30000,30000,40000,40000,40000,40000,40000,50000,60000,60000,60000,60000,60000,60000,10000,10000,10000,10000,10000,20000,20000,30000,30000,30000,30000,30000,30000,40000,40000,40000,40000,20000,20000,20000,20000,20000,20000,30000,30000,40000,50000,50000,50000,50000,50000,50000,60000,60000,70000,70000,70000,70000,80000,80000,80000,80000,80000,80000,80000,90000,90000,90000,90000,90000,90000,90000,90000,90000,90000,100000,110000,120000,130000,150000,150000,150000,150000,150000,150000,150000,150000,150000,150000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000]

filtered_inv_lines_to_post = [10000,20000,30000,50000,70000,80000,90000,120000,130000,140000,150000,160000,170000,180000,190000,200000,210000,220000,230000,240000,260000,270000,280000,290000,300000,310000,320000,330000,340000,350000,360000,370000,390000,400000,410000]

def generate_inv_line_nos_for_items_application(posted_invoice_nos,
                                                posted_invoice_line_nos_applied,
                                                filtered_inv_lines_to_post):

    indices_of_posted_inv_no_diffs = []
    posted_invoice_line_nos_applied.append(0)

    zipped_list = list(zip(posted_invoice_nos, posted_invoice_line_nos_applied))

    index_inv_line_diffs = np.insert(np.where(
        np.diff(posted_invoice_line_nos_applied) != 0)[0] + 1, 0, 0)

    for i in range(len(zipped_list)):
        try:
            if (posted_invoice_nos[i] != posted_invoice_nos[i + 1]) and \
                (posted_invoice_line_nos_applied[i] == \
                posted_invoice_line_nos_applied[i + 1]):
                indices_of_posted_inv_no_diffs.append(i + 1)
        except IndexError:
            pass

    index_diff = np.diff(np.sort(np.append(index_inv_line_diffs,
                       indices_of_posted_inv_no_diffs)))

    final_output_item_applied_sequence = np.repeat(
        filtered_inv_lines_to_post, index_diff)

    return final_output_item_applied_sequence

final_output = generate_inv_line_nos_for_items_application(
    posted_invoice_nos, posted_invoice_line_nos_applied,
    filtered_inv_lines_to_post)

np.savetxt("out_columns.csv", final_output, delimiter=",", fmt="%i")
