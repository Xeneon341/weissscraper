import numpy as np

posted_invoice_nos = ['PIV301069','PIV301069','PIV301069','PIV301069','PIV301069','PIV301069','PIV301069','PIV301069','PIV301069','PIV301069','PIV301069','PIV301069','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV301101','PIV302379','PIV302379','PIV302379','PIV302379','PIV302379','PIV302379','PIV302379','PIV302379','PIV302379','PIV302379','PIV302379','PIV302379','PIV302379','PIV302379','PIV302379','PIV302379','PIV302379','PIV302379','PIV302379','PIV302379','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302495','PIV302906','PIV302906','PIV302906','PIV302906','PIV302906','PIV302906','PIV302906','PIV302906','PIV302906','PIV302906','PIV302906','PIV302906','PIV302906','PIV302906','PIV302906','PIV302940','PIV302940','PIV302940','PIV302940','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303529','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303530','PIV303533','PIV303533','PIV303533','PIV303533','PIV303533','PIV303533','PIV303533','PIV303533','PIV303533','PIV303533','PIV303533','PIV303533','PIV303533','PIV303533','PIV303533','PIV303533','PIV303533','PIV303533','PIV303533','PIV303533','PIV303533','PIV303533','PIV303533','PIV303533','PIV303533','PIV303533','PIV303533','PIV303533','PIV303533','PIV303533','PIV303533','PIV303533','PIV303533','PIV303533','PIV303533','PIV303533','PIV303533','PIV303533','PIV303535','PIV303535','PIV303535','PIV303535','PIV303535','PIV303535','PIV303535','PIV303535','PIV303535','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303539','PIV303834','PIV303834','PIV303834','PIV303834','PIV303834','PIV303834','PIV303834','PIV303834','PIV303834','PIV303834','PIV303834','PIV303834','PIV303834','PIV303834','PIV303834','PIV303834','PIV303834','PIV303834','PIV303834','PIV303834','PIV303834','PIV303834','PIV303834','PIV303834','PIV303834','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV303875','PIV304065','PIV304065','PIV304065','PIV304065','PIV304065','PIV304065','PIV304065','PIV304065','PIV304065','PIV304065','PIV304065','PIV304065','PIV304065','PIV304065','PIV304065','PIV304065','PIV304065','PIV304065','PIV304065','PIV304065','PIV304065','PIV304065','PIV304065','PIV304065','PIV304065','PIV304065','PIV304065','PIV304065','PIV304065','PIV304065','PIV304065','PIV304065','PIV304065','PIV304066','PIV304066','PIV304066','PIV304066','PIV304066','PIV304066','PIV304066','PIV304066','PIV304066','PIV304066','PIV304066','PIV304066','PIV304066','PIV304066','PIV304066','PIV304066','PIV304067','PIV304067','PIV304067','PIV304067','PIV304067','PIV304067','PIV304067','PIV304067','PIV304067','PIV304067','PIV304067','PIV304067','PIV304067','PIV304067','PIV304067','PIV304067','PIV304068','PIV304068','PIV304068','PIV304068','PIV304068','PIV304068','PIV304068','PIV304068','PIV304068','PIV304068','PIV304068','PIV304068','PIV304068','PIV304068','PIV304068','PIV304068','PIV304070','PIV304070','PIV304070','PIV304070','PIV304070','PIV304070','PIV304070','PIV304070','PIV304070','PIV304070','PIV304070','PIV304070','PIV304070','PIV304070','PIV304070','PIV304070','PIV304070','PIV304070','PIV304070','PIV304070','PIV304070','PIV304070','PIV304345','PIV304345','PIV304345','PIV304345','PIV304345']


posted_invoice_line_nos_applied = [10000,10000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,10000,10000,10000,10000,10000,10000,10000,10000,20000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,40000,40000,40000,40000,40000,40000,50000,50000,50000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,
10000,10000,10000,10000,10000,10000,10000,10000,10000,20000,20000,20000,20000,20000,30000,40000,40000,40000,50000,50000,50000,60000,70000,70000,70000,70000,70000,70000,70000,70000,70000,70000,70000,70000,80000,80000,80000,80000,80000,80000,80000,80000,90000,90000,90000,90000,90000,90000,90000,90000,90000,90000,90000,90000,90000,90000,90000,90000,90000,90000,90000,90000,90000,90000,90000,90000,90000,90000,90000,90000,90000,90000,90000,90000,90000,90000,90000,90000,100000,100000,110000,120000,120000,120000,120000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,20000,20000,20000,10000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,30000,30000,30000,30000,30000,30000,30000,30000,30000,40000,40000,40000,40000,50000,50000,50000,50000,10000,20000,20000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,30000,40000,40000,40000,40000,50000,60000,60000,60000,60000,60000,70000,70000,70000,70000,70000,80000,80000,80000,80000,80000,80000,80000,80000,80000,80000,80000,80000,80000,80000,80000,90000,90000,90000,90000,90000,90000,90000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,30000,30000,40000,40000,40000,40000,40000,40000,40000,40000,40000,40000,40000,40000,40000,40000,40000,40000,40000,50000,50000,60000,60000,60000,60000,60000,60000,70000,80000,100000,110000,110000,110000,110000,110000,110000,110000,110000,110000,110000,110000,110000,110000,110000,110000,110000,110000,110000,110000,110000,110000,110000,110000,110000,110000,110000,110000,110000,110000,110000,110000,110000,110000,120000,120000,120000,120000,120000,120000,120000,120000,10000,20000,30000,30000,30000,40000,50000,50000,50000,50000,50000,60000,60000,60000,60000,70000,70000,80000,90000,100000,100000,100000,100000,100000,100000,20000,30000,40000,40000,40000,40000,40000,40000,40000,40000,40000,40000,40000,40000,40000,40000,40000,40000,50000,50000,60000,60000,70000,80000,80000,80000,80000,90000,90000,90000,90000,90000,90000,90000,90000,90000,110000,120000,120000,120000,120000,120000,120000,120000,120000,120000,120000,120000,120000,120000,120000,130000,130000,130000,130000,130000,140000,140000,140000,140000,140000,140000,140000,10000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,20000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,20000,20000,20000,20000,20000,20000,20000,30000,40000,50000,50000,60000,60000,60000,60000,70000,80000,90000,100000,100000,10000,10000,10000,10000,10000]


filtered_inv_lines_to_post = [20000,30000,50000,60000,70000,80000,90000,120000,140000,150000,160000,170000,180000,190000,200000,210000,220000,230000,240000,250000,260000,270000,310000,320000,330000,340000,350000,360000,370000,380000,390000,400000,410000,420000,430000,440000,450000,460000,470000,480000,490000,500000,510000,520000,530000,540000,560000,570000,580000,590000,600000,610000,620000,630000,640000,650000,660000,670000,680000,700000,710000,720000,730000,740000,750000,760000,770000,790000,800000,810000,820000,830000,840000,850000,860000,870000,880000,890000,900000,910000,920000,930000,940000,950000,960000,970000,990000]

posted_invoice_line_nos_applied.append(0)

zipped_list = list(zip(posted_invoice_nos, posted_invoice_line_nos_applied))

index_inv_line_diffs = np.where(np.diff(posted_invoice_line_nos_applied) != 0)[0] + 1
index_inv_line_diffs = np.insert(index_inv_line_diffs, 0, 0)

indices_of_posted_inv_no_diffs = []

for i in range(len(zipped_list)):
    try:
        if (posted_invoice_nos[i] != posted_invoice_nos[i + 1]) and (posted_invoice_line_nos_applied[i] == posted_invoice_line_nos_applied[i + 1]):
            indices_of_posted_inv_no_diffs.append(i + 1)
    except IndexError:
        pass

new_list = np.sort(np.append(index_inv_line_diffs, indices_of_posted_inv_no_diffs))
index_diff = np.diff(new_list)

print(index_diff)

# print(np.array(posted_invoice_line_nos_applied)[new_list][-1])
new_new_list = np.delete(np.array(posted_invoice_line_nos_applied)[new_list],[-1])
# print(new_new_list)

# inv_line_applied_multiplier = lambda a, b: [a[i]*b[i] for i in range(len(a))]
# inv_line_applied_multiplier = lambda a, b: [b for a]

final_output_sequence = np.repeat(new_new_list, index_diff)
print(final_output_sequence)
# for i in new_new_list:
#     for j in 3*[i]:
#         final_output_sequence.append(j)
#
# print(final_output_sequence)

# inv_line_applied_multiplier_mapper = np.array(inv_line_applied_multiplier(index_diff, new_new_list))
# print(inv_line_applied_multiplier_mapper)

print(len(list(zip(posted_invoice_nos[0::1],filtered_inv_lines_to_post[0::1], index_diff[0::1]))), len(filtered_inv_lines_to_post))
print(list(zip(posted_invoice_nos[0::1],filtered_inv_lines_to_post[0::1], index_diff[0::1])))
